<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <title>PubRTC + Mobile</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <link rel="stylesheet" type="text/css" href="https://dva-studio.github.io/tod/stylesheets/style.css" />
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css" />
    <script src="https://dva-studio.github.io/tod/js/modernizr.custom.js"></script>
	<link rel="stylesheet" type="text/css" href="https://dva-studio.github.io/tod/stylesheets/normalize.css" />
    <style>
        video {width:100%}
    </style>

    
</head>
<body>
    
    
    <button onclick="begin('alice')">Begin as Alice</button>
    <button onclick="begin('bob')">Begin as Bob</button>
    <button onclick="call('alice')">Call Alice</button>
    <button onclick="call('bob')">Call Bob</button>

    <video id="remoteVideo" autoplay></video>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdn.pubnub.com/pubnub.min.js"></script>
<script src="https://dva-studio.github.io/tod/js/classie.js"></script>
<script src="https://dva-studio.github.io/tod/js/webrtc.js"></script>

<script type="text/javascript">
    
    var videoWindow = document.getElementById("remoteVideo");
    
    function begin (n)
    {
        alert("Begin as " + n);
        var phone = window.phone = PHONE({
	    number        : n || "Anonymous", // listen on username line else Anonymous
	   publish_key   : 'pub-c-229d2ef7-d6fb-4387-80e9-3b142c8be097', // Your Pub Key
	    subscribe_key : 'sub-c-3c7c1fc8-5052-11e8-9796-063929a21258', // Your Sub Key,
        ssl: true
        });	    
	   //phone.ready(function(){form.username.style.background="#55ff5b"; form.login_submit.hidden="true"; });
        phone.receive(function(session){
            
            session.connected(function(session) 
            { 
                videoWindow.srcObject = session.video.srcObject;
            });
	       session.ended(function(session) { video_out.innerHTML=''; });
	   });    
        if (n == "bob")
        {
                
        }
    }
	
    
    function call (n)
    {
        phone.dial(n);
    }
    
    
    function makeCall(form){
        if (!window.phone) alert("Login First!");
        else phone.dial(form.number.value);
        return false;
    }

    function showModal(){
        $("#showModal").click();
    }

    function errWrap(fxn, form){
        try {
            return fxn(form);
        } catch(err) {
            alert("WebRTC is currently only supported by Chrome, Opera, and Firefox");
            return false;
        }
    }
</script>
</html>